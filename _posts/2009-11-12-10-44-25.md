---
layout: post
title: AJAX Minifier and a tool to view the output
---


<div style="padding-bottom: 0px; padding-left: 0px; width: 181px; padding-right: 0px; display: block; float: none; margin-left: auto; margin-right: auto; padding-top: 0px" id="scid:8747F07C-CDE8-481f-B0DF-C6CFD074BF67:fcf195c6-1908-48ef-beaf-11f6ce7e20f0" class="wlWriterEditableSmartContent"><a href="http://www.sharepoint-stuff.com/wp-content/uploads/2009/11/MinViewer8x6.png" title="Ajax Minifier Viewer" rel="thumbnail"><img border="0" src="http://www.sharepoint-stuff.com/wp-content/uploads/2009/11/MinViewer.png" width="171" height="158" /></a></div>  <p><a href="http://www.sharepoint-stuff.com/downloads/AjaxMinifierViewer.zip" target="_blank">Download the application here</a></p>  <p>Recently the the Microsoft AJAX team released Ajax Preview 6 up on codeplex (<a href="http://aspnet.codeplex.com/wikipage?title=AJAX&amp;referringTitle=Home" target="_blank">Check it out here</a>). With this release they also released an Ajax Minifier tool that will allow you to crunch or minify JS files. There are several ways to use the minifier tool, you can incorporate in into your build process using msbuild, you could run command line tool manually and create an output file, or you can use the minifier dll that gets distributed with the tool in your own applications. It is this third option that sparked my interest so I thought I would whip an application that allows you to load Javascript into an editor and then “crunch” it with the Ajax minifier object and visually see the output. Below is a screen shot of the final output. (I am adding a settings option so you can control how the minifier works)</p>  <p>&#160;</p>  <p><a href="http://www.sharepoint-stuff.com/wp-content/uploads/2009/11/image.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://www.sharepoint-stuff.com/wp-content/uploads/2009/11/image_thumb.png" width="867" height="686" /></a> </p>  <p>If you just want to grab the zip fie that has the exe in it to run, <a href="http://www.sharepoint-stuff.com/downloads/AjaxMinifierViewer.zip" target="_blank">you can grab it from here</a>. </p>  <p>The first thing we will need to do is grab and install the Ajax Minifier <a href="http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=34488" target="_blank">from here</a>. Once installed you will find the ajaxmin.dll file in the install location, like the following. It is that file that contains all the “crunching” code and the file you will need to reference in your project.</p>  <p><a href="http://www.sharepoint-stuff.com/wp-content/uploads/2009/11/image1.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://www.sharepoint-stuff.com/wp-content/uploads/2009/11/image_thumb1.png" width="392" height="243" /></a> </p>  <p>Once you have referenced the ajaxmin.dll file in your solution you will be able to “crunch” some javascript. In order to “crunch” the javascript you will need to make a call like the following.</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:0bf8de87-2099-4f07-9ad8-1c851a64b3c7" class="wlWriterEditableSmartContent"> <div style="border: #000080 1px solid; color: #000; font-family: 'Courier New', Courier, Monospace; font-size: 10pt"> <div style="background: #000080; color: #fff; font-family: Verdana, Tahoma, Arial, sans-serif; font-weight: bold; padding: 2px 5px">Code Snippet</div> <div style="background: #ddd; max-height: 300px; overflow: auto"> <ol style="background: #ffffff; margin: 0 0 0 2em; padding: 0 0 0 5px;"> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span style="color:#0000ff">string</span> Js = <span style="color:#a31515">@&quot;function ()</span></li> <li style="background: #f3f3f3">{</li> <li>&#160;&#160;&#160;&#160;<span style="color:#a31515">//these are some javascript comments</span></li> <li style="background: #f3f3f3">&#160;&#160;&#160;&#160;<span style="color:#a31515">var testVar = &#39;this is some alert text&#39;;</span></li> <li>&#160;&#160;&#160;&#160;<span style="color:#a31515">alert(&#39;Hey What are you doing!!!!, Crunch this stuff.....&#39;);</span></li> <li style="background: #f3f3f3">}<span style="color:#a31515">&quot;</span>;</li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Microsoft.Ajax.Utilities.<span style="color:#2b91af">ScriptCruncher</span> sc = <span style="color:#0000ff">new</span> Microsoft.Ajax.Utilities.<span style="color:#2b91af">ScriptCruncher</span>();</li> <li style="background: #f3f3f3">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span style="color:#0000ff">string</span> CrunchedJS = sc.Crunch(Js);</li> </ol> </div> </div> </div>  <p>&#160;</p>  <p>I also want to give credit to the #develop guys over at ic#code for putting out a excellent open source IDE for .NET development. I am using the #develop’s&#160; code editor control in this project to obtain the syntax highlighting, etc. Great work guys!! </p>  <p>you can check them out over at <a href="http://www.icsharpcode.net/OpenSource/SD/">http://www.icsharpcode.net/OpenSource/SD/</a></p>  <p>&#160;</p>  <p>That’s it for now and as always if you have any comments or questions you can comment here at the blog or catch me on twitter at <a href="http://twitter.com/johnmcbride">http://twitter.com/johnmcbride</a></p>
